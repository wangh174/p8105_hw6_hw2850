---
title: "p8105_hw6_hw2850"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

###Problem 2
```{r}
#read data
homicide = read_csv("data/homicide-data.csv") %>% 
  janitor::clean_names()
```

```{r}
homicide_tidy = homicide %>% 
  mutate(
    city_state = str_c(city, ", " ,state), #create city_state variable
    disposition = if_else(disposition %in% "Closed by arrest", 0, 1)
    ) %>% #make disposition a binary variable
  filter(!city_state %in% c("Dallas, TX", "Phoenix, AZ", "Kansas City, MO", "Tulsa, AL"),
         victim_race %in% c("White", "Black")) %>% #Only select white & black
  mutate(victim_age = as.numeric(victim_age)) %>% #make age numeric
  select(!c(city, state))
```

```{r}
Baltimore = homicide_tidy %>% 
  filter(city_state == "Baltimore, MD") #get Baltimore data

Baltimore_fit = Baltimore %>% 
  glm(disposition ~ victim_age + victim_sex + victim_race, data = ., family = binomial()) #run glm

Baltimore_results = Baltimore_fit %>% 
  broom::tidy() %>% 
  mutate(OR = exp(estimate)) %>%
  select(term, log_OR = estimate, OR, p.value) 

Baltimore_conf = confint(Baltimore_fit)
```

```{r}
#write a glm function
glm_fun = function(homicide_tidy){
  
  glm = glm(disposition ~ victim_age + victim_sex + victim_race, data = ., family = binomial())
  
}
```

